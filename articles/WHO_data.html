<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WHO Data â€¢ CAvaccines</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="WHO Data">
<meta property="og:description" content="CAvaccines">
<meta property="og:image" content="https://arisp99.github.io/CAvaccines/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CAvaccines</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vaccine_disease.html">Vaccines and Infectious Disease</a>
    </li>
    <li>
      <a href="../articles/WHO_data.html">WHO Data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/arisp99/Cavaccines/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="WHO_data_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>WHO Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/arisp99/Cavaccines/blob/master/vignettes/WHO_data.Rmd"><code>vignettes/WHO_data.Rmd</code></a></small>
      <div class="hidden name"><code>WHO_data.Rmd</code></div>

    </div>

    
    
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">CAvaccines</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># Population Numbers</span>
<span class="no">population_file</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(
  <span class="st">"extdata"</span>,
  <span class="st">"population-by-country.xlsx"</span>,
  <span class="kw">package</span> <span class="kw">=</span> <span class="st">"CAvaccines"</span>
)

<span class="no">population_country</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(
  <span class="kw pkg">readxl</span><span class="kw ns">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span>(<span class="no">population_file</span>,
                     <span class="kw">na</span> <span class="kw">=</span> <span class="st">""</span>,
                     <span class="kw">range</span> <span class="kw">=</span> <span class="st">"B2:D191"</span>,
                     <span class="kw">col_names</span> <span class="kw">=</span> <span class="fl">FALSE</span>))
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">population_country</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ISO_code"</span>, <span class="st">"Year"</span>, <span class="st">"Population"</span>)
<span class="no">population_country</span>$<span class="no">Year</span> <span class="kw">&lt;-</span> <span class="kw">NULL</span>

<span class="co"># Incidence</span>
<span class="no">incidence_file</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(
  <span class="st">"extdata"</span>,
  <span class="st">"incidence_series.xls"</span>,
  <span class="kw">package</span> <span class="kw">=</span> <span class="st">"CAvaccines"</span>
)

<span class="no">incidence_series</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(
  <span class="kw pkg">readxl</span><span class="kw ns">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span>(<span class="no">incidence_file</span>,
                     <span class="kw">sheet</span> <span class="kw">=</span> <span class="st">"Pertussis"</span>,
                     <span class="kw">na</span> <span class="kw">=</span> <span class="st">""</span>,
                     <span class="kw">col_names</span> <span class="kw">=</span> <span class="fl">TRUE</span>))

<span class="no">incidence_series</span> <span class="kw">&lt;-</span> <span class="no">incidence_series</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="no">Year</span>, <span class="no">Cases</span>, -<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">WHO_REGION</span>, <span class="no">ISO_code</span>, <span class="no">Cname</span>, <span class="no">Disease</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>()

<span class="no">incidence_series</span>$<span class="no">Cname</span> <span class="kw">&lt;-</span> <span class="kw pkg">stringr</span><span class="kw ns">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span>(<span class="no">incidence_series</span>$<span class="no">Cname</span>, <span class="st">" \\(.*\\)"</span>)
<span class="no">incidence_series</span>$<span class="no">Cname</span>[<span class="no">incidence_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"United States of America"</span>] <span class="kw">&lt;-</span> <span class="st">"USA"</span>
<span class="no">incidence_series</span>$<span class="no">Cname</span>[<span class="no">incidence_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"Russian Federation"</span>] <span class="kw">&lt;-</span> <span class="st">"Russia"</span>

<span class="no">incidence_series</span> <span class="kw">&lt;-</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span>(<span class="no">incidence_series</span>, <span class="no">population_country</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"ISO_code"</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Cases</span> <span class="kw">=</span> <span class="no">Cases</span> / <span class="no">Population</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">incidence_series</span>)
<span class="co">#&gt; tibble [6,159 Ã— 7] (S3: tbl_df/tbl/data.frame)</span>
<span class="co">#&gt;  $ WHO_REGION: chr [1:6159] "EMR" "EUR" "AFR" "EUR" ...</span>
<span class="co">#&gt;  $ ISO_code  : chr [1:6159] "AFG" "ALB" "DZA" "AND" ...</span>
<span class="co">#&gt;  $ Cname     : chr [1:6159] "Afghanistan" "Albania" "Algeria" "Andorra" ...</span>
<span class="co">#&gt;  $ Disease   : chr [1:6159] "pertussis" "pertussis" "pertussis" "pertussis" ...</span>
<span class="co">#&gt;  $ Year      : chr [1:6159] "2018" "2018" "2018" "2018" ...</span>
<span class="co">#&gt;  $ Cases     : num [1:6159] 2.04e-05 5.47e-06 5.59e-07 2.99e-05 0.00 ...</span>
<span class="co">#&gt;  $ Population: num [1:6159] 23898198 3473835 30429000 66824 10377000 ...</span>
<span class="co">#&gt;  - attr(*, "na.action")= 'omit' Named int [1:1407] 19 28 31 34 38 50 56 63 64 65 ...</span>
<span class="co">#&gt;   ..- attr(*, "names")= chr [1:1407] "19" "28" "31" "34" ...</span>

<span class="co"># Coverage</span>
<span class="no">coverage_file</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(
  <span class="st">"extdata"</span>,
  <span class="st">"Numeric_coverage_series.xls"</span>,
  <span class="kw">package</span> <span class="kw">=</span> <span class="st">"CAvaccines"</span>
)

<span class="no">coverage_series</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(
  <span class="kw pkg">readxl</span><span class="kw ns">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span>(<span class="no">coverage_file</span>,
                     <span class="kw">sheet</span> <span class="kw">=</span> <span class="st">"world_coverage"</span>,
                     <span class="kw">na</span> <span class="kw">=</span> <span class="st">""</span>,
                     <span class="kw">range</span> <span class="kw">=</span> <span class="kw pkg">readxl</span><span class="kw ns">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/cell-specification.html">cell_cols</a></span>(<span class="st">"A:G"</span>),
                     <span class="kw">col_names</span> <span class="kw">=</span> <span class="fl">TRUE</span>))

<span class="no">coverage_series</span> <span class="kw">&lt;-</span> <span class="no">coverage_series</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Percent_covrage</span> <span class="kw">=</span> <span class="no">Percent_covrage</span>/ <span class="fl">100</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span>(<span class="no">Vaccine</span>, <span class="no">Percent_covrage</span>)

<span class="no">coverage_series</span>$<span class="no">Year</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">coverage_series</span>$<span class="no">Year</span>)
<span class="no">coverage_series</span> <span class="kw">&lt;-</span> <span class="no">coverage_series</span>[, <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span>(!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">coverage_series</span>)) <span class="kw">&gt;</span> <span class="fl">0.40</span>)]

<span class="co"># Fixing country names</span>
<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">&lt;-</span> <span class="kw pkg">stringr</span><span class="kw ns">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span>(<span class="no">coverage_series</span>$<span class="no">Cname</span>, <span class="st">" \\(.*\\)"</span>)
<span class="no">coverage_series</span>$<span class="no">Cname</span>[<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"Brunei Darussalam"</span>] <span class="kw">&lt;-</span> <span class="st">"Brunei"</span>
<span class="no">coverage_series</span>$<span class="no">Cname</span>[<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"Cabo Verde"</span>] <span class="kw">&lt;-</span> <span class="st">"Cape Verde"</span>
<span class="no">coverage_series</span>$<span class="no">Cname</span>[<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"Congo"</span>] <span class="kw">&lt;-</span> <span class="st">"Republic of Congo"</span>
<span class="no">coverage_series</span>$<span class="no">Cname</span>[<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"CÃ´te d'Ivoire"</span>] <span class="kw">&lt;-</span> <span class="st">"Ivory Coast"</span>
<span class="no">coverage_series</span>$<span class="no">Cname</span>[<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"Democratic People's Republic of Korea"</span>] <span class="kw">&lt;-</span> <span class="st">"North Korea"</span>
<span class="no">coverage_series</span>$<span class="no">Cname</span>[<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"Lao People's Democratic Republic"</span>] <span class="kw">&lt;-</span> <span class="st">"Laos"</span>
<span class="no">coverage_series</span>$<span class="no">Cname</span>[<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"North Macedonia"</span>] <span class="kw">&lt;-</span> <span class="st">"Macedonia"</span>
<span class="no">coverage_series</span>$<span class="no">Cname</span>[<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"Republic of Moldova"</span>] <span class="kw">&lt;-</span> <span class="st">"Moldova"</span>
<span class="no">coverage_series</span>$<span class="no">Cname</span>[<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"Syrian Arab Republic"</span>] <span class="kw">&lt;-</span> <span class="st">"Syria"</span>
<span class="no">coverage_series</span>$<span class="no">Cname</span>[<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"United Republic of Tanzania"</span>] <span class="kw">&lt;-</span> <span class="st">"Tanzania"</span>
<span class="no">coverage_series</span>$<span class="no">Cname</span>[<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"Viet Nam"</span>] <span class="kw">&lt;-</span> <span class="st">"Vietnam"</span>
<span class="no">coverage_series</span>$<span class="no">Cname</span>[<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"United States of America"</span>] <span class="kw">&lt;-</span> <span class="st">"USA"</span>
<span class="no">coverage_series</span>$<span class="no">Cname</span>[<span class="no">coverage_series</span>$<span class="no">Cname</span> <span class="kw">==</span> <span class="st">"Russian Federation"</span>] <span class="kw">&lt;-</span> <span class="st">"Russia"</span></pre></body></html></div>
</div>
<div id="visualize" class="section level2">
<h2 class="hasAnchor">
<a href="#visualize" class="anchor"></a>Visualize</h2>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">to_map</span> <span class="kw">&lt;-</span> <span class="no">coverage_series</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">Cname</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(
      <span class="kw">BCG</span>      <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">BCG</span>*<span class="fl">100</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="no">T</span>),
      <span class="kw">DTP1</span>     <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">DTP1</span>*<span class="fl">100</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="no">T</span>),
      <span class="kw">DTP3</span>     <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">DTP3</span>*<span class="fl">100</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="no">T</span>),
      <span class="kw">HepB3</span>    <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">HepB3</span>*<span class="fl">100</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="no">T</span>),
      <span class="kw">MCV1</span>     <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">MCV1</span>*<span class="fl">100</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="no">T</span>),
      <span class="kw">TT2plus</span>  <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">TT2plus</span>*<span class="fl">100</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="no">T</span>))
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>

<span class="co"># Determine min and max values</span>
<span class="no">min_v</span> <span class="kw">=</span> <span class="kw pkg">DescTools</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/DescTools/man/RoundTo.html">RoundTo</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">to_map</span>$<span class="no">DTP3</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="no">T</span>), <span class="fl">5</span>)
<span class="no">max_v</span> <span class="kw">=</span> <span class="kw pkg">DescTools</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/DescTools/man/RoundTo.html">RoundTo</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">to_map</span>$<span class="no">DTP3</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="no">T</span>), <span class="fl">5</span>)
<span class="no">diff</span> <span class="kw">=</span> <span class="no">max_v</span> - <span class="no">min_v</span>

<span class="co"># Based on min and max values, determine optimal breaks. We stipulate</span>
<span class="co"># that there shoud be at least five breaks</span>
<span class="kw">if</span> (<span class="no">diff</span> <span class="kw">&lt;=</span> <span class="fl">5</span>){
  <span class="no">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">min_v</span>, <span class="no">max_v</span>, <span class="fl">1</span>)
} <span class="kw">else</span> <span class="kw">if</span> (<span class="no">diff</span> <span class="kw">&lt;=</span> <span class="fl">25</span>){
  <span class="no">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">min_v</span>, <span class="no">max_v</span>, <span class="fl">5</span>)
} <span class="kw">else</span> {
  <span class="no">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">min_v</span>, <span class="no">max_v</span>, <span class="fl">10</span>)
}

<span class="no">countries</span> <span class="kw">=</span> <span class="kw pkg">ggplot2</span><span class="kw ns">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/map_data.html">map_data</a></span>(<span class="st">"world"</span>)
<span class="co"># setdiff(to_map$Cname, countries$region)</span>
<span class="co"># setdiff(countries$region, to_map$Cname)</span>

<span class="co"># Combine mapping data and our data</span>
<span class="no">world_map</span> <span class="kw">=</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span>(<span class="no">countries</span>, <span class="no">to_map</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"region"</span> <span class="kw">=</span> <span class="st">"Cname"</span>))

<span class="co"># Create map</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">world_map</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">.data</span>$<span class="no">long</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">.data</span>$<span class="no">lat</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">.data</span>$<span class="no">group</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">DTP3</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_quickmap</a></span>() + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span>(<span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>) +
  <span class="kw pkg">viridis</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/viridis/man/scale_viridis.html">scale_fill_viridis</a></span>(<span class="kw">option</span> <span class="kw">=</span> <span class="st">"viridis"</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="no">breaks</span>, <span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">min_v</span>, <span class="no">max_v</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">plot.title</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">15</span>),
      <span class="kw">legend.title</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>), <span class="kw">legend.text</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Plot of DTP Rates in the World"</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"Rates (%)"</span>)</pre></body></html></div>
<p><img src="WHO_data_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="modeling" class="section level2">
<h2 class="hasAnchor">
<a href="#modeling" class="anchor"></a>Modeling</h2>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">incidence_series_2015</span> <span class="kw">&lt;-</span> <span class="no">incidence_series</span> <span class="kw">%&gt;%</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">Year</span> <span class="kw">==</span> <span class="st">"2015"</span>)
<span class="no">coverage_series_2015</span> <span class="kw">&lt;-</span> <span class="no">coverage_series</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">Year</span> <span class="kw">==</span> <span class="st">"2015"</span>)
<span class="no">coverage_series_2015</span>$<span class="no">TT2plus</span> <span class="kw">&lt;-</span> <span class="kw">NULL</span>

<span class="no">combined_2015</span> <span class="kw">&lt;-</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span>(<span class="no">incidence_series_2015</span>, <span class="no">coverage_series_2015</span>,
                   <span class="kw">by</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"WHO_REGION"</span>, <span class="st">"ISO_code"</span>, <span class="st">"Cname"</span>, <span class="st">"Year"</span>)) <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">Cases</span>, <span class="no">BCG</span>, <span class="no">DTP1</span>, <span class="no">DTP3</span>, <span class="no">HepB3</span>, <span class="no">MCV1</span>, <span class="no">Pol3</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>()

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">combined_2015</span>)
<span class="co">#&gt; 'data.frame':    100 obs. of  7 variables:</span>
<span class="co">#&gt;  $ Cases: num  0.13 -0.41 -0.41 0.369 -0.145 ...</span>
<span class="co">#&gt;  $ BCG  : num  0.448 0.597 -0.968 0.597 0.597 ...</span>
<span class="co">#&gt;  $ DTP1 : num  0.58 0.58 0.214 0.122 0.397 ...</span>
<span class="co">#&gt;  $ DTP3 : num  0.657 0.456 -0.549 0.389 0.389 ...</span>
<span class="co">#&gt;  $ HepB3: num  0.659 0.458 -0.545 0.391 0.391 ...</span>
<span class="co">#&gt;  $ MCV1 : num  0.0877 0.4659 -0.6685 0.0121 0.6171 ...</span>
<span class="co">#&gt;  $ Pol3 : num  0.624 0.469 -0.463 0.314 0.547 ...</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">0</span>)
<span class="no">t_sample</span> <span class="kw">=</span> <span class="kw pkg">caTools</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/caTools/man/sample.split.html">sample.split</a></span>(<span class="no">combined_2015</span>$<span class="no">Cases</span>, <span class="kw">SplitRatio</span> <span class="kw">=</span> <span class="fl">0.7</span>)
<span class="no">t_train</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">combined_2015</span>, <span class="no">t_sample</span> <span class="kw">==</span> <span class="fl">TRUE</span>)
<span class="no">t_test</span>  <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">combined_2015</span>, <span class="no">t_sample</span> <span class="kw">==</span> <span class="fl">FALSE</span>)

<span class="no">lm</span> <span class="kw">&lt;-</span> <span class="kw pkg">stats</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Cases</span> ~<span class="no">.</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">t_train</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">lm</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; stats::lm(formula = Cases ~ ., data = t_train)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -0.4592 -0.3527 -0.2263 -0.0620  4.8742 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="co">#&gt; (Intercept) -0.08086    0.09711  -0.833    0.408</span>
<span class="co">#&gt; BCG          0.04164    0.15337   0.272    0.787</span>
<span class="co">#&gt; DTP1        -0.04643    0.25908  -0.179    0.858</span>
<span class="co">#&gt; DTP3         0.95612    1.45467   0.657    0.513</span>
<span class="co">#&gt; HepB3       -0.81563    1.36304  -0.598    0.552</span>
<span class="co">#&gt; MCV1        -0.22438    0.28365  -0.791    0.432</span>
<span class="co">#&gt; Pol3         0.15761    0.44761   0.352    0.726</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.7964 on 63 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.02868,    Adjusted R-squared:  -0.06383 </span>
<span class="co">#&gt; F-statistic:  0.31 on 6 and 63 DF,  p-value: 0.9295</span>

<span class="no">predict_lm</span> <span class="kw">&lt;-</span> <span class="no">lm</span> <span class="kw">%&gt;%</span> <span class="kw pkg">stats</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">t_test</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Test R2 Linear:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw pkg">caret</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/postResample.html">R2</a></span>(<span class="no">predict_lm</span>, <span class="no">t_test</span>$<span class="no">Cases</span>), <span class="fl">4</span>)))
<span class="co">#&gt; [1] "Test R2 Linear: 0.0528"</span></pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Aris Paschalidis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
